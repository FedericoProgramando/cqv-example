(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9944],{9944:function(e,t,a){"use strict";a.d(t,{Z:function(){return P}});var n=a(5893),o=a(7294),i=a(1664),c=a.n(i),l=a(9367),s=a(3403),r=a(4152),d=a.n(r),p=a(7814),u=a(9417),x=a(2592);let h=e=>{let{data:t}=e,[a,i]=(0,o.useState)("");return(0,o.useEffect)(()=>{let e=async()=>{let e=await x.toDataURL(null==t?void 0:t.lnurl);i(e)};e()},[t]),(0,n.jsxs)("section",{className:d().qrSection,children:[(0,n.jsxs)("div",{className:d().qrTitle,children:[(0,n.jsxs)("span",{children:[t.qr?"Escane\xe1 y pag\xe1 con":"Pag\xe1 con"," "]}),(0,n.jsx)("img",{src:"/imgs/ln1_logo.png",alt:"Lightning Network",height:"30px"})]}),a&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("img",{className:d().imageQR,src:a,alt:"QR MercadoPago"}),(0,n.jsxs)("div",{className:d().waitingPayment,children:[(0,n.jsx)(p.G,{className:d().spinner,icon:u.LM3,width:"20"})," ","Esperando transacci\xf3n"]})]}),(null==t?void 0:t.mercadoPagoLink)&&(0,n.jsx)("a",{href:t.mercadoPagoLink,children:"Pagar en MercadoPago.com"})]})};var m=a(9655),g=a.n(m),f=a(4184),_=a.n(f),v=a(6154),j=a(6064);let C=e=>{var t,a;let{setModalCheckout:o,user:i}=e;return(0,n.jsxs)("button",{className:g().openPopupCheckout,onClick:()=>{o(!0)},children:[(0,n.jsx)("img",{src:"https://cdn.cafecito.app/imgs/cafecito_logo_white.svg",width:"28px",height:"25px",alt:""}),(null==i?void 0:null===(t=i.texts)||void 0===t?void 0:t.button_mobile)?null==i?void 0:null===(a=i.texts)||void 0===a?void 0:a.button_mobile:"Invitame un Cafecito"]})},b=()=>(0,n.jsxs)("span",{className:g().withOutPayment,children:["Debes agregar un m\xe9todo de pago desde la secci\xf3n de"," ",(0,n.jsx)(c(),{href:"/my_account?tab=payment#payment",children:"Mi cuenta"})," para empezar a recibir cafecitos."]}),y=()=>(0,n.jsx)("span",{className:g().withOutPayment,children:"El creador debe agregar un m\xe9todo de pago para empezar a recibir cafecitos."}),k=e=>{var t,a;let{countCoffees:o,setCountCoffees:i,setCoffees:c,user:l}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:(null==l?void 0:null===(t=l.texts)||void 0===t?void 0:t.title)?null==l?void 0:null===(a=l.texts)||void 0===a?void 0:a.title:"\xa1Ayudame con un caf\xe9!"}),(0,n.jsxs)("div",{className:g().containerInputCoffee,children:[(0,n.jsx)("div",{className:g().imageCoffee,children:(0,n.jsx)("img",{src:"https://cdn.cafecito.app/imgs/cafecito_logo.svg",width:"32px",height:"28px",alt:""})}),(0,n.jsx)("span",{className:g().multiplier,children:"x"}),(0,n.jsxs)("div",{className:g().countCoffeesContainer,children:[(0,n.jsx)("button",{onClick:()=>{o>1&&i(e=>Number(e)-1)},children:"-"}),(0,n.jsx)("input",{type:"text",placeholder:"1",value:o,onChange:e=>{c(e.target.value)}}),(0,n.jsx)("button",{onClick:()=>{i(e=>Number(e)+1)},children:"+"})]}),(0,n.jsxs)("div",{className:g().buttonCoffeesContainer,children:[(0,n.jsx)("button",{className:"".concat(3===parseInt(o)?g().selected:null),onClick:()=>{i(3)},children:"3"}),(0,n.jsx)("button",{className:"".concat(5===parseInt(o)?g().selected:null),onClick:()=>{i(5)},children:"5"}),(0,n.jsx)("button",{className:"".concat(10===parseInt(o)?g().selected:null),onClick:()=>{i(10)},children:"10"})]})]})]})},w=e=>{let{isMobile:t,fetchComplete:a,loadingText:o,lnUrl:i}=e;return(0,n.jsxs)("div",{className:g().loading,style:{display:!t&&a?"none":"block"},children:[!i&&(0,n.jsx)("span",{children:o}),i&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:g().informationSend,children:"Para completar la transacci\xf3n debes ir a tu billetera que soporte Lightning Network, hacer el envio de los $BTC y volver a esta p\xe1gina. En cuanto detectemos el pago completo te lo mostraremos en la pantalla, puede tardar unos segundos."}),(0,n.jsxs)("div",{className:g().waitingPayment,children:[(0,n.jsx)(p.G,{className:g().spinner,icon:u.LM3,width:"20"})," ","Esperando transacci\xf3n"]}),(0,n.jsx)("a",{href:"lightning:".concat(i),className:g().goToWallet,style:{background:"#23272c"},children:"Ir a la billetera de $BTC"})]})]})},N=e=>{var t,a,i,c;let{isMobile:r,price:d=100,username:p,user:u,userSession:x,handleShowMore:m,hasPlans:f=!1}=e,[j,N]=(0,o.useState)(""),[T,P]=(0,o.useState)(""),[S,I]=(0,o.useState)(1),[L,M]=(0,o.useState)(""),[W,q]=(0,o.useState)(!1),[z,E]=(0,o.useState)(!1),[R,B]=(0,o.useState)({mercadoPagoLink:"",qr:""}),[V,A]=(0,o.useState)("Creando caf\xe9..."),[Z,F]=(0,o.useState)(!r||!u.paymentValid),[H,O]=(0,o.useState)({lnurl:"",id:""}),Q="",D=async()=>{let e=(0,l.ZP)("".concat("https://cafecito.app"),{path:"/socket/socket.io"});e.on("sendToThankYouPage",e=>{window.location.href="".concat("https://cafecito.app","/").concat(p,'?external_reference={"coffeeId":"').concat(e.coffeeId,'"}')}),e.on("reconnect",()=>{e.emit("assignCoffeeId",{coffeeId:Q})}),q(!0);try{let t=await v.Z.post("".concat("https://cafecito.app/api","/send_coffee"),{name:j,message:L,contact:T,countCoffees:S||1,QR:!r,username:p},{withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}});r?t.data.mercadoPagoLink?window.location.href=t.data.mercadoPagoLink:A("Hubo un problema creando el cafecito. Intente nuevamente en unos minutos."):(m&&m(!0),e.emit("assignCoffeeId",{coffeeId:t.data.coffeeId}),Q=t.data.coffeeId,B(t.data),E(!0))}catch(e){var t,a;A((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.message)||"Hubo un problema creando el cafecito. Intente nuevamente en unos minutos.")}},J=async()=>{let e=!1;A("Creando caf\xe9..."),q(!0);let t=await v.Z.post("".concat("https://cafecito.app/api","/send_coffee_lightning"),{name:j,message:L,contact:T,countCoffees:S||1,username:p},{withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}});O(null==t?void 0:t.data),E(!0);let a=setInterval(async()=>{if(!e){var n,o,i,c,l;let s=await v.Z.get("https://api.opennode.com/checkouts/status/".concat(null==t?void 0:null===(n=t.data)||void 0===n?void 0:n.id));(null==s?void 0:null===(o=s.data)||void 0===o?void 0:null===(i=o.data)||void 0===i?void 0:i.status)=="paid"&&(clearInterval(a),e=!0,await v.Z.get("".concat("https://cafecito.app/api","/get_payment_by_coffe/").concat(null==t?void 0:null===(c=t.data)||void 0===c?void 0:c.coffeeId),{withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}}),window.location.href="".concat("https://cafecito.app","/").concat(p,'?external_reference={"coffeeId":"').concat(null==t?void 0:null===(l=t.data)||void 0===l?void 0:l.coffeeId,'"}'))}},1e3)},$=e=>{e>0&&e.match(/^[0-9]+$/)?I(e):I(1)},G=S||1;return(0,n.jsxs)("header",{className:g().inputText,children:[r&&u.paymentValid&&(0,n.jsx)(C,{setModalCheckout:F,user:u}),(0,n.jsxs)("div",{className:_()(g().checkoutContainer,!u.paymentValid&&g().checkoutNotValid),style:{display:Z?"block":"none"},children:[(0,n.jsx)("div",{className:g().checkoutWrapper,children:W?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(w,{isMobile:r,fetchComplete:z,loadingText:V,lnUrl:null==H?void 0:H.lnurl}),!r&&z&&!(null==H?void 0:H.lnurl)&&(0,n.jsx)(s.Z,{data:R}),!r&&z&&(null==H?void 0:H.lnurl)&&(0,n.jsx)(h,{data:H})]}):u.paymentValid?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k,{countCoffees:S,setCountCoffees:I,setCoffees:$,user:u}),(0,n.jsx)("input",{type:"text",value:j,placeholder:"Nombre (opcional)",onChange:e=>{N(e.target.value)},maxLength:"50"}),(0,n.jsx)("input",{type:"text",value:T,placeholder:"Contacto (opcional, campo oculto al p\xfablico)",className:g().contactField,onChange:e=>{P(e.target.value)}}),(0,n.jsx)("textarea",{maxLength:"500",placeholder:"Mensaje (opcional)",value:L,onChange:e=>{M(e.target.value.slice(0,500))}}),(0,n.jsx)("div",{className:g().payWithContainer,children:(0,n.jsx)("div",{className:g().payWithHR,children:(0,n.jsx)("div",{className:g().text,children:"Invitame ".concat(G," ").concat(parseInt(G)>1?(null==u?void 0:null===(t=u.texts)||void 0===t?void 0:t.button_plural)?null==u?void 0:null===(a=u.texts)||void 0===a?void 0:a.button_plural:"Cafecito":(null==u?void 0:null===(i=u.texts)||void 0===i?void 0:i.button_singular)?null==u?void 0:null===(c=u.texts)||void 0===c?void 0:c.button_singular:"Cafecito"," (ARS $").concat(G*d,") con")})})}),(null==u?void 0:u.paymentMercadoPagoValid)&&(0,n.jsx)("button",{className:g().sendButton,style:{background:"#c6e9fa"},onClick:D,children:(0,n.jsxs)("picture",{children:[(0,n.jsx)("source",{type:"image/webp",srcSet:"https://cdn.cafecito.app/imgs/version-horizontal-large-mp.webp, https://cdn.cafecito.app/imgs/version-horizontal-large-mp@2x.webp 2x, https://cdn.cafecito.app/imgs/version-horizontal-large-mp@4x.webp 4x",alt:"MercadoPago Logo",media:"(max-width: 768px)"}),(0,n.jsx)("source",{type:"image/webp",srcSet:"https://cdn.cafecito.app/imgs/version-horizontal-large-mp@2x.webp, https://cdn.cafecito.app/imgs/version-horizontal-large-mp@4x.webp 2x",alt:"MercadoPago Logo"}),(0,n.jsx)("img",{src:"https://cdn.cafecito.app/imgs/version-horizontal-large-mp@2x.png",alt:"MercadoPago Logo",loading:"lazy"})]})}),(null==u?void 0:u.paymentsLightningNetwork)&&(0,n.jsx)("button",{className:g().sendButton,style:{background:"#23272c"},onClick:J,children:(0,n.jsxs)("picture",{children:[(0,n.jsx)("source",{type:"image/webp",srcSet:"https://cdn.cafecito.app/imgs/ln2_logo.webp, https://cdn.cafecito.app/imgs/ln2_logo@2x.webp 2x, https://cdn.cafecito.app/imgs/ln2_logo@4x.webp 4x",alt:"Bitcoin Logo",media:"(max-width: 768px)"}),(0,n.jsx)("source",{type:"image/webp",srcSet:"https://cdn.cafecito.app/imgs/ln2_logo@2x.webp, https://cdn.cafecito.app/imgs/ln2_logo@4x.webp 2x",alt:"Bitcoin Logo"}),(0,n.jsx)("img",{src:"https://cdn.cafecito.app/imgs/ln2_logo@2x.png",alt:"Bitcoin Logo",loading:"lazy"})]})}),(null==u?void 0:u.paymentMercadoPagoValid)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:g().infoPayment,children:"* MercadoPago no procesa pagos del exterior de Argentina."}),f&&(0,n.jsx)("div",{className:g().infoPayment,children:"* Los cafecitos no desbloquean contenido de la galeria."})]})]}):(null==x?void 0:x.username)==p?(0,n.jsx)(b,{}):(0,n.jsx)(y,{})}),(0,n.jsx)("div",{className:g().backgroundWithOpacity,onClick:()=>{F(!1)}})]})]})},T=e=>{let{user:t}=e;return{userSession:t}};var P=(0,j.$j)(T)(N)},4152:function(e){e.exports={qrSection:"qrln_qrSection__nGtai",qrTitle:"qrln_qrTitle__EiJk0",imageQR:"qrln_imageQR__5lxXN",waitingPayment:"qrln_waitingPayment__ArDMi",spinner:"qrln_spinner__6u4d9",spin:"qrln_spin__vcRbk"}},9655:function(e){e.exports={inputText:"inputText_inputText__LfApS",openPopupCheckout:"inputText_openPopupCheckout__JsHw1",checkoutContainer:"inputText_checkoutContainer__zSEYC",checkoutWrapper:"inputText_checkoutWrapper__DPfMJ",checkoutNotValid:"inputText_checkoutNotValid__3ccHH",backgroundWithOpacity:"inputText_backgroundWithOpacity__oGWi5",withOutPayment:"inputText_withOutPayment__iVwlk",loading:"inputText_loading__gMt9Z",informationSend:"inputText_informationSend__0j7kj",goToWallet:"inputText_goToWallet__1ExAS",waitingPayment:"inputText_waitingPayment__UTutZ",spinner:"inputText_spinner__XObua",spin:"inputText_spin__YxQrf",containerInputCoffee:"inputText_containerInputCoffee__ESZw0",imageCoffee:"inputText_imageCoffee__37TDv",selected:"inputText_selected__iUDtj",buttonCoffeesContainer:"inputText_buttonCoffeesContainer__CVyfm",countCoffeesContainer:"inputText_countCoffeesContainer__eAQJK",contactField:"inputText_contactField__zBv5g",wrapperCheckbox:"inputText_wrapperCheckbox__ykKJ0",checkmark:"inputText_checkmark__Ll_yM",sendButton:"inputText_sendButton__9PLiW",payWithContainer:"inputText_payWithContainer__QRwP3",payWithHR:"inputText_payWithHR__xCxs8",infoPayment:"inputText_infoPayment__SB0vI"}}}]);