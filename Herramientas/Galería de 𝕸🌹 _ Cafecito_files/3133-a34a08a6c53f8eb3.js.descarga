(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3133],{240:function(e,t,a){"use strict";var s=a(5893),i=a(7294),n=a(1664),o=a.n(n),l=a(602),r=a(4184),c=a.n(r),d=a(8005),p=a.n(d),m=a(6154),u=a(7814),_=a(9417),x=a(8803),h=a.n(x);let g=(0,i.createContext)({}),v=e=>{let{children:t}=e,{post:a}=(0,i.useContext)(l.Z),[n,o]=(0,i.useState)({title:"",description:"",image:"",private:!1,plans:[]}),[r,c]=(0,i.useState)({title:!1,description:!1,image:!1,private:!1,plans:!1,err:""}),[d,p]=(0,i.useState)(!1),[m,u]=(0,i.useState)(null),_=(0,i.useRef)(null);return(0,i.useEffect)(()=>{a?o({title:null==a?void 0:a.title,description:null==a?void 0:a.description,image:null==a?void 0:a.image,private:(null==a?void 0:a.private)||!1,plans:null==a?void 0:a.plans}):o({title:"",description:"",image:"",private:!1,plans:[]})},[a]),(0,s.jsx)(g.Provider,{value:{fileImage:m,setFileImage:u,fileImageEl:_,post:n,setPost:o,loading:d,setLoading:p,dataPost:a,dataPostErr:r,setDataPostErr:c},children:t})},j=e=>{let{name:t,title:a,placeholder:n,maxLength:o,type:l="text",err:r}=e,{post:d,setPost:p,dataPostErr:m,setDataPostErr:u}=(0,i.useContext)(g);return(0,s.jsxs)("section",{className:c()(h().groupInput,m[t]&&h().showError),children:[(0,s.jsx)("input",{type:l,id:t,name:t,placeholder:n||a,maxLength:o,onChange:e=>{p({...d,[t]:e.target.value}),u({...m,[t]:!1})},value:d[t]}),m[t]&&r&&(0,s.jsx)("span",{className:h().error,children:r})]})},w=()=>{let{post:e,setPost:t,dataPostErr:a,setDataPostErr:n}=(0,i.useContext)(g);return(0,s.jsxs)("section",{className:c()(h().groupInput,a.description&&h().showError),children:[(0,s.jsx)("textarea",{id:"description",name:"description",placeholder:"Mensaje (opcional)",maxLength:"20000",value:e.description,onChange:s=>{t({...e,description:s.target.value}),n({...a,description:!1})}}),a.description&&(0,s.jsx)("span",{className:h().error,children:"Un post debe tener un mensaje o una imagen."})]})},P=()=>{let{plans:e,show:t,user:a}=(0,i.useContext)(l.Z),{post:n,dataPost:r,setPost:c,dataPostErr:d,setDataPostErr:p}=(0,i.useContext)(g),[m,x]=(0,i.useState)(!1);(0,i.useEffect)(()=>{x((null==r?void 0:r.private)||!1)},[t]),(0,i.useEffect)(()=>{x(null==r?void 0:r.private)},[r]);let v=e=>{var t;(null==n?void 0:null===(t=n.plans)||void 0===t?void 0:t.includes(e))?c({...n,plans:n.plans.filter(t=>t!==e)}):c({...n,plans:[...n.plans||[],e]})};return(0,s.jsxs)("section",{className:h().subsWrapper,children:[(0,s.jsx)("div",{className:h().title,children:"\xbfQui\xe9nes pueden ver este post?"}),(0,s.jsxs)("label",{className:h().optionSub,children:[(0,s.jsx)("input",{name:"private",type:"radio",checked:!n.private,onChange:()=>{x(!1),p({...d,plans:!1}),c({...n,private:!1})}})," ","P\xfablico"]}),(0,s.jsxs)("label",{className:h().optionSub,children:[(0,s.jsx)("input",{name:"private",type:"radio",checked:n.private,onChange:()=>{x(!0),c({...n,private:!0})}})," ","Suscriptores"]}),(0,s.jsxs)("ul",{className:h().listPlans,style:{display:m?"block":"none"},children:[(0,s.jsx)("div",{className:h().title,children:(null==e?void 0:e.length)?"Selecciona los planes que van a tener acceso":(0,s.jsxs)("span",{children:["Para crear un post para suscriptores primero debes crear un"," ",(0,s.jsx)(o(),{href:"/".concat(a.username,"/plans"),children:"plan"})]})}),null==e?void 0:e.map(e=>{var t;return(0,s.jsx)("li",{children:(0,s.jsxs)("label",{children:[(0,s.jsxs)("div",{className:h().checkboxWrapper,children:[(0,s.jsx)("input",{type:"checkbox",onChange:()=>{p({...d,plans:!1}),v(e._id)},checked:null==n?void 0:null===(t=n.plans)||void 0===t?void 0:t.includes(e._id)}),(0,s.jsx)(u.G,{icon:_.LEp,width:"15"})]}),(0,s.jsxs)("div",{className:h().planInfo,children:[(0,s.jsx)("span",{className:h().planTitle,children:e.title}),(0,s.jsx)("span",{className:h().planPrice,children:"$".concat(e.price," por mes")})]})]})},e._id)})]}),d.plans&&(0,s.jsx)("span",{className:h().error,children:"Debes seleccionar un plan."})]})},f=()=>{let{fileImage:e,setFileImage:t,fileImageEl:a,post:n,loading:o,setLoading:r,dataPost:c,dataPostErr:d,setDataPostErr:x}=(0,i.useContext)(g),{setShow:v,setShowPost:j,setPost:w,reloadPost:P}=(0,i.useContext)(l.Z),[f,C]=(0,i.useState)(0),b=async()=>{var s;let i={};if(""===n.title&&(i.title=!0),""!=n.description||(null==c?void 0:c.image)||e||(i.description=!0),!n.private||(null==n?void 0:null===(s=n.plans)||void 0===s?void 0:s.length)||(i.plans=!0),x({...d,...i}),!Object.keys(i).length){r(!0);let s={id:null==c?void 0:c._id,title:n.title,description:n.description,private:n.private,plans:n.plans},i=new FormData;if(i.append("bodyJson",JSON.stringify(s)),e){if("image/gif"!==e.type){let t=await new Promise(t=>{new(p())(e,{maxWidth:2e3,success(e){t(e)}})});i.append("file",t)}else i.append("file",e)}try{let e=await m.Z.post("".concat("https://cafecito.app/api","/user/post"),i,{withCredentials:!0,headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e=>{C("".concat(Math.round(100*e.loaded/e.total),"%"))}});C(0),t(null),a.current.value="",r(!1),v("none"),j&&j("block"),w(e.data),P(e.data,!(null==c?void 0:c._id))}catch(e){}}};return(0,s.jsxs)("footer",{children:[(0,s.jsxs)("label",{className:h().containerImageUpload,children:[e?(0,s.jsx)("img",{className:h().imageUpload,src:URL.createObjectURL(e),alt:""}):(null==n?void 0:n.image)&&(0,s.jsx)("img",{className:h().imageUpload,src:null==n?void 0:n.image,alt:""}),(0,s.jsx)("img",{src:"https://cdn.cafecito.app/imgs/icon_cloud.svg",className:h().uploadImageIcon,alt:""}),(0,s.jsx)("input",{className:h().inputFile,onChange:e=>{e.target.files[0]&&e.target.files[0].size>4e6?(t(null),x({...d,image:!0,err:""})):e.target.files[0]&&"image/jpeg"!==e.target.files[0].type&&"image/jpg"!==e.target.files[0].type&&"image/png"!==e.target.files[0].type&&"image/gif"!==e.target.files[0].type?(t(null),x({...d,image:!1,err:"Solo se permiten fotos en formato JPG, PNG y GIF"})):e.target.files[0]&&(t(e.target.files[0]),x({...d,description:!1,err:"",image:!1}))},type:"file",ref:a,accept:".png, .jpg, .jpeg, .gif, image/jpeg, image/png"}),d.image&&(0,s.jsx)("span",{className:h().err,children:"El peso m\xe1ximo permitido es 4MB"}),d.err&&(0,s.jsx)("span",{className:h().err,children:d.err})]}),(0,s.jsxs)("button",{onClick:b,disabled:o,children:[(0,s.jsx)("div",{className:h().loadingBar,style:{width:f}}),o?(0,s.jsxs)("span",{className:h().spinnerContainer,children:[(0,s.jsx)(u.G,{className:h().spinner,icon:_.LM3,width:"20"})," ","Procesando"]}):(null==c?void 0:c._id)?"Guardar":"Postear"]})]})},C=()=>{let{setPost:e}=(0,i.useContext)(g),{setShow:t,setPost:a}=(0,i.useContext)(l.Z);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("header",{children:[(0,s.jsx)("h5",{children:"\xbfQu\xe9 quer\xe9s compartir hoy?"}),(0,s.jsx)("img",{src:"https://cdn.cafecito.app/imgs/icon_cross.svg",alt:"",width:"16px",height:"16px",onClick:()=>{e(!1),a(!1),t("none")}})]}),(0,s.jsxs)("div",{className:h().faqContent,children:["El contenido a publicar debe seguir las"," ",(0,s.jsx)(o(),{href:"/faq/que-contenido-se-puede-publicar",children:"normas de contenido"})," ","caso contrario se proceder\xe1 a eliminar y suspender la cuenta."]})]})},b=e=>{let{children:t}=e,{show:a}=(0,i.useContext)(l.Z);return(0,s.jsx)("section",{className:h().modalContainer,style:{display:a},children:t})},N=()=>(0,s.jsx)(v,{children:(0,s.jsxs)(b,{children:[(0,s.jsxs)("div",{className:h().modalWrapper,children:[(0,s.jsx)(C,{}),(0,s.jsxs)("section",{className:h().scrollSection,children:[(0,s.jsx)(j,{name:"title",title:"T\xedtulo",maxLength:"80",err:"Debes ingresar un t\xedtulo"}),(0,s.jsx)(w,{}),(0,s.jsx)(P,{}),(0,s.jsx)(f,{})]})]}),(0,s.jsx)("div",{className:h().modalBackground})]})});t.Z=N},8800:function(e,t,a){"use strict";var s=a(5893),i=a(7294),n=a(4318),o=a(4184),l=a.n(o),r=a(7814),c=a(9417),d=a(3024),p=a(6154),m=a(5573),u=a.n(m),_=a(602),x=a(23),h=a.n(x);let g=(0,i.createContext)({}),v=e=>{let{children:t}=e,[a,n]=(0,i.useState)(!1),[o,l]=(0,i.useState)(!1),[r,c]=(0,i.useState)(!1);return(0,s.jsx)(g.Provider,{value:{copyLinkModal:a,setCopyLinkModal:n,deletePostModal:o,setDeletePostModal:l,activeZoom:r,setActiveZoom:c},children:t})},j=e=>{let{children:t}=e,{showPost:a,setPost:n,setShowPost:o,postFinal:r}=(0,i.useContext)(_.Z),{setCopyLinkModal:c,activeZoom:d}=(0,i.useContext)(g);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("section",{className:l()(h().modalContainerPost,r&&h().modalPostFinal),style:{display:a},children:[t,(0,s.jsx)("div",{className:h().modalBackground,onClick:()=>{c(!1),n(!1),o("none")}})]}),d&&(0,s.jsx)(P,{})]})},w=()=>{let{copyLinkModal:e,setCopyLinkModal:t}=(0,i.useContext)(g),{post:a,user:o}=(0,i.useContext)(_.Z),[l,p]=(0,i.useState)("Copiar Link"),[m,u]=(0,i.useState)(!1),[x,v]=(0,i.useState)(!1);(0,i.useEffect)(()=>{u(!1),v(!1)},[e]);let j="";!1!==a&&(j="".concat("https://cafecito.app","/").concat(o.username,"/post/").concat(a&&a.pathUrl));let w=()=>(window.open("https://twitter.com/intent/tweet?text=".concat(j),"targetWindow","toolbar=no,location=0,status=no,menubar=no,scrollbars=yes,resizable=yes,width=600,height=250"),!1),P=()=>{if(void 0===navigator.clipboard){let e=document.createElement("textarea");e.value=j,e.style.position="fixed",document.body.appendChild(e),e.focus(),e.select(),document.execCommand("copy"),document.body.removeChild(e);return}navigator.clipboard.writeText(j),p("Link copiado")};(0,i.useEffect)(()=>{let e=async()=>{if(x){u(!1);let e=await f("https://images.cafecito.app/api/post/".concat(a._id,"?orientation=portrait"));u(e)}};e()},[x]);let f=e=>fetch(e).then(e=>e.blob()).then(e=>URL.createObjectURL(e)),C=async(e,t)=>{let a=document.createElement("a");a.href=await f(e),a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)};return(0,s.jsx)(n.Z,{title:"Compartir",openModal:e,nameModal:"copyLinkModal",openModalCreateEvent:t,children:(0,s.jsxs)("section",{className:h().copyLinkWrapper,children:[(0,s.jsx)("div",{style:{display:x?"none":"block"},children:(0,s.jsx)("input",{type:"text",value:"".concat(j),readOnly:!0})}),(0,s.jsx)("div",{className:h().imgStory,style:{display:x?"block":"none"},children:m?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{className:h().image,src:m,alt:""}),(0,s.jsx)("div",{children:"*Descargar imagen y subir a Instagram Story"}),(0,s.jsx)("button",{className:h().buttonInstagram,onClick:()=>{C(m,"cafecito-post-story.png")},children:"Descargar imagen"})]}):(0,s.jsx)("div",{children:"Creando imagen..."})}),!x&&(0,s.jsxs)("div",{className:h().buttonShare,children:[(0,s.jsxs)("button",{className:h().buttonTwitter,onClick:w,children:[(0,s.jsx)(r.G,{icon:d.mdU,width:"14"}),(0,s.jsx)("span",{children:"Twitter"})]}),(0,s.jsxs)("button",{className:h().buttonInstagram,onClick:()=>{v(!0)},children:[(0,s.jsx)(r.G,{icon:d.Zzi,width:"14"}),(0,s.jsx)("span",{children:"Instagram Story"})]}),(0,s.jsxs)("button",{className:h().buttonCopy,onClick:P,children:[(0,s.jsx)(r.G,{icon:c.kZ_,width:"14"}),(0,s.jsx)("span",{children:l})]})]})]})})},P=()=>{let{post:e}=(0,i.useContext)(_.Z),{setActiveZoom:t}=(0,i.useContext)(g);return(0,s.jsxs)("div",{className:h().zoomWrapper,children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:h().imageZoomWrapper,children:[(0,s.jsx)("img",{className:h().image,src:e.image,alt:""}),(0,s.jsx)(r.G,{className:h().iconZoom,icon:c.vsP,onClick:()=>t(!1)})]}),(0,s.jsx)("div",{className:h().title,children:e.title})]}),(0,s.jsx)("div",{className:h().zoomBackground,onClick:()=>t(!1)})]})},f=()=>{let{deletePostModal:e,setDeletePostModal:t}=(0,i.useContext)(g),{post:a,removePost:o,setShowPost:l,setPost:r}=(0,i.useContext)(_.Z),c=async()=>{await p.Z.delete("".concat("https://cafecito.app/api","/user/post/").concat(a._id),{withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}}),t(!1),l("none"),r(!1),o(a)};return(0,s.jsx)(n.Z,{title:"\xbfEst\xe1s seguro que quieres borrar este post?",openModal:e,openModalCreateEvent:()=>{t(!e)},color:"#ff6961",children:(0,s.jsxs)("div",{className:h().modalButtonsDeletePost,children:[(0,s.jsx)("button",{className:h().cancel,onClick:()=>{t(!1)},children:"Cancelar"}),(0,s.jsx)("button",{className:h().success,onClick:c,children:"Borrar"})]})})},C=()=>{var e;let t;let{setCopyLinkModal:a,setDeletePostModal:n,setActiveZoom:o}=(0,i.useContext)(g),{post:l,setShowPost:d,setPost:p,setShow:m,isUserEdit:x,setShowBuyPlan:v,userRedux:j,setShowRegisterPopup:w}=(0,i.useContext)(_.Z),[P,f]=(0,i.useState)(!1),[C,b]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(f(!1),null==l?void 0:l.image){let e=new Image;e.onload=()=>{f(!0)},e.src=null==l?void 0:l.image}(null==l?void 0:l.seeMoreActive)&&b(!0)},[l]);let N=(null==l?void 0:null===(e=l.description)||void 0===e?void 0:e.length)>=400;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("header",{children:[(0,s.jsxs)("h2",{children:[l.private&&(0,s.jsx)(r.G,{icon:c.byT,width:"12"})," ",l.title]}),(0,s.jsx)("img",{src:"https://cdn.cafecito.app/imgs/icon_cross.svg",alt:"",width:"16px",height:"16px",onClick:()=>{p(!1),d("none")}})]}),(0,s.jsxs)("div",{className:h().scrollSection,children:[P?(0,s.jsxs)("div",{className:h().imageWrapper,children:[(0,s.jsx)("img",{className:h().image,src:l.image,onClick:()=>o(!0)}),(0,s.jsx)(r.G,{className:h().iconZoom,icon:c.N7g,onClick:()=>o(!0)})]}):(null==l?void 0:l.image)&&!P&&(0,s.jsx)("div",{className:h().loadingImage,children:(0,s.jsxs)("div",{className:h().loadingWrapper,children:[(0,s.jsx)(r.G,{className:h().spinner,icon:c.LM3,width:"20"}),(0,s.jsx)("span",{children:"Cargando imagen"})]})}),l.private&&!x&&!l.unlock&&(0,s.jsx)("div",{className:h().private,onClick:()=>{!l.private||x||(null==j?void 0:j._id)?v(!0):w(!0)},children:(0,s.jsxs)("div",{className:h().privateWrapper,children:[(0,s.jsx)("img",{src:"https://cdn.cafecito.app/imgs/cafecito-lock.svg"}),(0,s.jsx)("span",{children:"Desbloquear contenido"})]})}),l.description&&(0,s.jsxs)("section",{className:h().description,style:{height:!C&&N?"200px":"auto"},children:[(0,s.jsx)("article",{dangerouslySetInnerHTML:{__html:u()(l.description).replace(/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,'<a href="$1" target="_blank" rel="noopener noreferrer nofollow">$1</a>').replace(/(^|[^\/])(www\.[\S]+(\b|$))/gim,'$1<a href="http://$2" target="_blank" rel="noopener noreferrer nofollow">$2</a>').replace(/(([a-zA-Z0-9_\-\.]+)@[a-zA-Z_]+?(?:\.[a-zA-Z]{2,6}))+/gim,'<a href="mailto:$1">$1</a>')}}),!C&&N&&(0,s.jsx)("div",{className:h().shadowShowMore})]}),(0,s.jsxs)("section",{className:h().actions,children:[(0,s.jsxs)("div",{className:h().actionsWrapper,children:[x&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{className:h().editIcon,src:"https://cdn.cafecito.app/imgs/icon_pencil.svg",alt:"",height:"24px",onClick:()=>{d&&d("none"),m("block")}}),(0,s.jsx)("img",{className:h().deleteIcon,src:"https://cdn.cafecito.app/imgs/icon_trash.svg",alt:"",height:"24px",onClick:()=>{n(!0)}})]}),(0,s.jsx)("img",{src:"https://cdn.cafecito.app/imgs/icon_share.svg",alt:"",height:"24px",onClick:()=>a(!0)})]}),!C&&N&&(0,s.jsx)("div",{className:h().seeMore,onClick:()=>{b(!0)},children:"Ver m\xe1s"})]})]})]})},b=()=>{let{post:e}=(0,i.useContext)(_.Z);return(0,s.jsxs)(v,{children:[(0,s.jsx)(j,{children:(0,s.jsx)("div",{className:h().modalWrapper,children:e?(0,s.jsx)(C,{}):(0,s.jsx)(r.G,{className:h().spinner,icon:c.LM3,width:"20"})})}),(0,s.jsx)(w,{}),(0,s.jsx)(f,{})]})};t.Z=b},8803:function(e){e.exports={modalContainer:"createPostModal_modalContainer__ko4Mn",spinnerContainer:"createPostModal_spinnerContainer__Dp5iR",spinner:"createPostModal_spinner__vY7zH",spin:"createPostModal_spin___HgbZ",modalWrapper:"createPostModal_modalWrapper__QQ6HK",faqContent:"createPostModal_faqContent__U4VXN",groupInput:"createPostModal_groupInput__UirP3",error:"createPostModal_error__HYKSa",showError:"createPostModal_showError__p9nlK",loadingBar:"createPostModal_loadingBar__ErkI_",containerImageUpload:"createPostModal_containerImageUpload__G8d5l",inputFile:"createPostModal_inputFile__C5o4r",imageUpload:"createPostModal_imageUpload__6eWlk",uploadImageIcon:"createPostModal_uploadImageIcon__WFEkj",err:"createPostModal_err__PZz5W",subsWrapper:"createPostModal_subsWrapper__INn_b",title:"createPostModal_title__wWPBx",optionSub:"createPostModal_optionSub__npC1i",listPlans:"createPostModal_listPlans__WMFnJ",checkboxWrapper:"createPostModal_checkboxWrapper__CQLOa",planInfo:"createPostModal_planInfo__FIDdt",planPrice:"createPostModal_planPrice__nDHVl",modalBackground:"createPostModal_modalBackground__V6bVE"}},23:function(e){e.exports={modalButtonsDeletePost:"viewPost_modalButtonsDeletePost__dVGny",cancel:"viewPost_cancel__rDn3g",success:"viewPost_success__G8iAb",zoomWrapper:"viewPost_zoomWrapper__71NAI",imageZoomWrapper:"viewPost_imageZoomWrapper__aQxXz",image:"viewPost_image__qO0JK",title:"viewPost_title__GxUGH",zoomBackground:"viewPost_zoomBackground__FyGjp",copyLinkWrapper:"viewPost_copyLinkWrapper__yOhQ0",imgStory:"viewPost_imgStory__WpiNe",buttonInstagram:"viewPost_buttonInstagram__aaixK",buttonShare:"viewPost_buttonShare__jH4yz",buttonTwitter:"viewPost_buttonTwitter__pT65X",buttonCopy:"viewPost_buttonCopy__f2_T2",modalContainerPost:"viewPost_modalContainerPost__lpC42",spinner:"viewPost_spinner__jMOEK",spin:"viewPost_spin__qlbuH",modalWrapper:"viewPost_modalWrapper__96RAX",scrollSection:"viewPost_scrollSection__lwgYi",imageWrapper:"viewPost_imageWrapper__z5QEZ",iconZoom:"viewPost_iconZoom__wrscd",private:"viewPost_private__0IzB4",privateWrapper:"viewPost_privateWrapper__XgidV",planType:"viewPost_planType__Lv_bp",lock:"viewPost_lock__0YSlN",description:"viewPost_description__vy6By",shadowShowMore:"viewPost_shadowShowMore__MRaLT",actions:"viewPost_actions__ZwlVD",editIcon:"viewPost_editIcon__EowZ_",deleteIcon:"viewPost_deleteIcon__ypBbq",seeMore:"viewPost_seeMore__Iq8na",loadingImage:"viewPost_loadingImage__QIhID",loadingWrapper:"viewPost_loadingWrapper__r9KyA",modalBackground:"viewPost_modalBackground__LEq6C",modalPostFinal:"viewPost_modalPostFinal__POgue"}}}]);